{
  "format":1,
  "language":"BASIC",
  "version":13,
  "name":"Reading a CSV file",
  "author":"Peter Millican",
  "date":"31/08/2020",
  "time":"11:18:32",
  "code":"REM ReadCSV\n\nCONST cols% = 10\nCONST rows% = 10\nCONST fname$ = \"SaveCSV.csv\"\nSTRINGSIZE 64\nDIM value%(cols%, rows%)\nPROCsetup\nPROCdrawgrid\nPROClabelgrid\nPROCreaddata\nPROCdisplay\nWRITELN(\"File \" + fname$ + \" has been read\")\nEND\n\nDEF PROCsetup\n  colwidth% = 1000 DIV (cols% + 1)\n  rowheight% = 900 DIV (rows% + 1)\n  xmargin% = colwidth% * 3 / 7\n  ymargin% = rowheight% / 3\n  fontsize% = colwidth% / 4\nENDPROC\n\nDEF PROCdrawgrid\n  LOCAL i%, j%\n  FOR i% = 0 TO cols% + 1\n    IF (i% = 0) OR (i% = 1) OR (i% = cols% + 1) THEN\n      THICKNESS(10)\n    ELSE\n      THICKNESS(2)\n    ENDIF\n    SETXY(5 + i% * colwidth%, 5)\n    DRAWXY(0, 890)\n  NEXT\n  FOR j% = 0 TO rows% + 1\n    IF (j% = 0) OR (j% = 1) OR (j% = rows% + 1) THEN\n      THICKNESS(10)\n    ELSE\n      THICKNESS(2)\n    ENDIF\n    SETXY(5, 5 + j% * rowheight%)\n    DRAWXY(995, 0)\n  NEXT\nENDPROC\n\nDEF PROClabelgrid\n  LOCAL i%, j%\n  SETXY(colwidth% - 25, 5)\n  PRINT(\"x\", 0, 30)\n  SETXY(20, rowheight% - 45)\n  PRINT(\"y\", 0, 30)\n  SETXY(300, 925)\n  PRINT(\"Table read from file\", 0, 40)\n  FOR i% = 1 TO cols%\n    SETXY(i% * colwidth% + xmargin%, ymargin%)\n    PRINT(STR$(i%), 0, fontsize%)\n  NEXT\n  FOR j% = 1 TO rows%\n    SETXY(xmargin%, j% * rowheight% + ymargin%)\n    PRINT(STR$(j%), 0, fontsize%)\n  NEXT\nENDPROC\n\nDEF PROCdisplay\n  LOCAL i%, j%\n  FOR i% = 1 TO cols%\n    FOR j% = 1 TO rows%\n      SETXY(i% * colwidth% + xmargin%, j% * rowheight% + ymargin%)\n      PRINT(STR$(value%(i%, j%)), 0, fontsize%)\n    NEXT\n  NEXT\nENDPROC\n\nDEF FNnextbit$(RETURN s$)\n  LOCAL posn%, result$\n  posn% = INSTR(s$, \",\")\n  IF posn% = 0 THEN\n    result$ = s$\n    s$ = \"\"\n  ELSE\n    result$ = MID$(s$, 1, posn% - 1)\n    s$ = DEL$(s$, 1, posn%)\n  ENDIF\n= result$\n\nDEF PROCreaddata\n  LOCAL handle%, i%, j%, thisline$, thisbit$\n  i% = 0\n  handle% = OPENIN(fname$)\n  WHILE NOT(EOF#(handle%))\n    INC(i%)\n    thisline$ = FREADLN#(handle%)\n    j% = 0\n    WHILE thisline$ <> \"\"\n      INC(j%)\n      thisbit$ = FNnextbit$(thisline$)\n      value%(i%, j%) = VAL(thisbit$)\n    ENDWHILE\n  ENDWHILE\n  CLOSE#(handle%)\nENDPROC",
  "usage":[
    {
      "category": "Turtle: relative movement",
      "expressions":[
        {"name":"DRAWXY", "level":2, "count":2, "lines":"33 42"}
      ],
      "total":2
    },
    {
      "category": "Turtle: absolute movement",
      "expressions":[
        {"name":"SETXY", "level":1, "count":8, "lines":"32 41 48 50 52 55 59 68"}
      ],
      "total":8
    },
    {
      "category": "Other Turtle commands",
      "expressions":[
        {"name":"THICKNESS", "level":1, "count":4, "lines":"28 30 37 39"}
      ],
      "total":4
    },
    {
      "category": "General arithmetic functions",
      "expressions":[
        {"name":"INC", "level":1, "count":2, "lines":"91 95"}
      ],
      "total":2
    },
    {
      "category": "String operations",
      "expressions":[
        {"name":"PRINT", "level":1, "count":6, "lines":"49 51 53 56 60 69"},
        {"name":"WRITELN", "level":1, "count":1, "lines":"13"},
        {"name":"DEL$", "level":3, "count":1, "lines":"82"},
        {"name":"INSTR", "level":3, "count":1, "lines":"76"},
        {"name":"MID$", "level":3, "count":1, "lines":"81"}
      ],
      "total":10
    },
    {
      "category": "Type conversion routines",
      "expressions":[
        {"name":"STR$", "level":1, "count":3, "lines":"56 60 69"},
        {"name":"VAL", "level":1, "count":1, "lines":"97"}
      ],
      "total":4
    },
    {
      "category": "File processing",
      "expressions":[
        {"name":"CLOSE#", "level":2, "count":1, "lines":"100"},
        {"name":"EOF#", "level":2, "count":1, "lines":"90"},
        {"name":"FREADLN#", "level":2, "count":1, "lines":"92"},
        {"name":"OPENIN", "level":2, "count":1, "lines":"89"}
      ],
      "total":4
    },
    {
      "category": "Command structures",
      "expressions":[
        {"name":"IF", "level":1, "count":3, "lines":"27 36 77"},
        {"name":"ELSE", "level":1, "count":3, "lines":"29 38 80"},
        {"name":"FOR", "level":1, "count":6, "lines":"26 35 54 58 66 67"},
        {"name":"WHILE", "level":2, "count":2, "lines":"90 94"},
        {"name":"DEF PROC", "level":2, "count":5, "lines":"16 24 46 64 86"},
        {"name":"DEF FN", "level":3, "count":1, "lines":"74"}
      ],
      "total":20
    },
    {
      "category": "Subroutine calls",
      "expressions":[
        {"name":"FNnextbit$", "level":0, "count":1, "lines":"96"},
        {"name":"PROCsetup", "level":0, "count":1, "lines":"8"},
        {"name":"PROCdrawgrid", "level":0, "count":1, "lines":"9"},
        {"name":"PROClabelgrid", "level":0, "count":1, "lines":"10"},
        {"name":"PROCreaddata", "level":0, "count":1, "lines":"11"},
        {"name":"PROCdisplay", "level":0, "count":1, "lines":"12"}
      ],
      "total":6
    }
  ],
  "pcode":[
    [112,19,1,1,112,0,123,112,6,2,123,4,112,156,124,112,175,138],
    [80,112,2,85,112,360,84,112,32,162,112,1,123,141,112,0,1,112,1000,1,1,1,145,144],
    [116,27,119,26],
    [112,11,119,27,116,39,119,28],
    [112,11,119,39,116,51,119,29],
    [112,11,119,51,116,63,119,30],
    [112,11,119,63,116,75,119,31],
    [112,11,119,75,116,87,119,32],
    [112,11,119,87,116,99,119,33],
    [112,11,119,99,116,111,119,34],
    [112,11,119,111,116,123,119,35],
    [112,11,119,123,116,135,119,36],
    [112,11,119,135,116,147,119,37],
    [112,11,119,147,116,159,119,38],
    [112,11,119,159],
    [128,113],
    [133,1],
    [112,1000,112,10,112,1,26,30,119,171],
    [112,900,112,10,112,1,26,30,119,172],
    [113,171,112,3,28,112,7,29,119,173],
    [113,172,112,3,29,119,174],
    [113,171,112,4,29,119,175],
    [134,132],
    [133,2],
    [139,13,2],
    [112,0],
    [120,13,1,112,10,112,1,26],
    [114,13,1,37,129,36],
    [114,13,1,112,0,32,114,13,1,112,1,32,18,114,13,1,112,10,112,1,26,32,18,129,32],
    [112,10,85],
    [128,33],
    [112,2,85],
    [112,5,114,13,1,113,171,28,26,112,5,88],
    [112,0,112,890,90],
    [114,13,1,4,128,27],
    [112,0],
    [120,13,2,112,10,112,1,26],
    [114,13,2,37,129,46],
    [114,13,2,112,0,32,114,13,2,112,1,32,18,114,13,2,112,10,112,1,26,32,18,129,42],
    [112,10,85],
    [128,43],
    [112,2,85],
    [112,5,112,5,114,13,2,113,172,28,26,88],
    [112,995,112,0,90],
    [114,13,2,4,128,37],
    [140,13,134,132],
    [133,3],
    [139,14,2],
    [113,171,112,25,27,112,5,88],
    [118,1,120,112,0,112,30,168,142],
    [112,20,113,172,112,45,27,88],
    [118,1,121,112,0,112,30,168,142],
    [112,300,112,925,88],
    [118,20,84,97,98,108,101,32,114,101,97,100,32,102,114,111,109,32,102,105,108,101,112,0,112,40,168,142],
    [112,1],
    [120,14,1,112,10],
    [114,14,1,37,129,61],
    [114,14,1,113,171,28,113,173,26,113,174,88],
    [114,14,1,11,112,0,113,175,168,142],
    [114,14,1,4,128,56],
    [112,1],
    [120,14,2,112,10],
    [114,14,2,37,129,67],
    [113,173,114,14,2,113,172,28,113,174,26,88],
    [114,14,2,11,112,0,113,175,168,142],
    [114,14,2,4,128,62],
    [140,14,134,132],
    [133,4],
    [139,15,2],
    [112,1],
    [120,15,1,112,10],
    [114,15,1,37,129,80],
    [112,1],
    [120,15,2,112,10],
    [114,15,2,37,129,79],
    [114,15,1,113,171,28,113,173,26,114,15,2,113,172,28,113,174,26,88],
    [113,26,114,15,1,2,127,26,4,122,114,15,2,2,127,26,4,122,11,112,0,113,175,168,142],
    [114,15,2,4,128,74],
    [114,15,1,4,128,71],
    [140,15,134,132],
    [133,5],
    [139,16,136],
    [117,16,3,120,16,1,112,65,120,16,2,120,16,68],
    [117,16,72,120,16,70,112,65,120,16,71],
    [114,16,68,118,1,44,2,70,120,16,69,142],
    [114,16,69,112,0,32,129,90],
    [114,16,70,114,16,68,2,126],
    [114,16,68,118,0,2,126,142],
    [128,92],
    [114,16,70,114,16,68,112,1,114,16,69,112,1,27,67,2,126,142],
    [114,16,68,114,16,68,112,1,114,16,69,68,2,126,142],
    [114,16,1,114,16,70,2,126],
    [113,16,119,18,140,16,134,132],
    [133,6],
    [139,17,137],
    [117,17,6,120,17,4,112,65,120,17,5],
    [117,17,73,120,17,71,112,65,120,17,72],
    [112,0,120,17,2],
    [118,11,83,97,118,101,67,83,86,46,99,115,118,112,1,179,120,17,1,142],
    [114,17,1,182,16,129,111],
    [117,17,2,1,122,4,2,123],
    [114,17,4,114,17,1,185,2,126,142],
    [112,0,120,17,3],
    [114,17,4,118,0,41,142,129,110],
    [117,17,3,1,122,4,2,123],
    [114,17,71,114,17,4,131,81],
    [114,18,1,8,2,126,142],
    [113,26,114,17,2,2,127,26,4,122,114,17,3,2,127,26,4,114,17,71,112,0,13,2,123],
    [128,104],
    [128,100],
    [114,17,1,180],
    [140,17,134,132],
    [131,17],
    [131,24],
    [131,47],
    [131,94],
    [131,68],
    [118,5,70,105,108,101,32,118,11,83,97,118,101,67,83,86,46,99,115,118,64,118,14,32,104,97,115,32,98,101,101,110,32,114,101,97,100,64,169,170,142],
    [130]
  ]
}
