{
  "format":1,
  "language":"BASIC",
  "version":13,
  "name":"Saving a CSV file",
  "author":"Peter Millican",
  "date":"31/08/2020",
  "time":"11:18:32",
  "code":"REM SaveCSV\n\nCONST cols% = 10\nCONST rows% = 10\nCONST a% = 3\nCONST b% = 4\nCONST fname$ = \"SaveCSV.csv\"\nDIM value%(cols%, rows%)\nPROCsetup\nPROCdrawgrid\nPROClabelgrid\nPROCcalculate\nPROCdisplay\nPROCsavedata\nWRITELN(\"File \" + fname$ + \" has been saved\")\nEND\n\nDEF PROCsetup\n  colwidth% = 1000 DIV (cols% + 1)\n  rowheight% = 900 DIV (rows% + 1)\n  xmargin% = colwidth% * 3 / 7\n  ymargin% = rowheight% / 3\n  fontsize% = colwidth% / 4\nENDPROC\n\nDEF PROCdrawgrid\n  LOCAL i%, j%\n  FOR i% = 0 TO cols% + 1\n    IF (i% = 0) OR (i% = 1) OR (i% = cols% + 1) THEN\n      THICKNESS(10)\n    ELSE\n      THICKNESS(2)\n    ENDIF\n    SETXY(5 + i% * colwidth%, 5)\n    DRAWXY(0, 890)\n  NEXT\n  FOR j% = 0 TO rows% + 1\n    IF (j% = 0) OR (j% = 1) OR (j% = rows% + 1) THEN\n      THICKNESS(10)\n    ELSE\n      THICKNESS(2)\n    ENDIF\n    SETXY(5, 5 + j% * rowheight%)\n    DRAWXY(995, 0)\n  NEXT\nENDPROC\n\nDEF PROClabelgrid\n  LOCAL i%, j%\n  SETXY(colwidth% - 25, 5)\n  PRINT(\"x\", 0, 30)\n  SETXY(20, rowheight% - 45)\n  PRINT(\"y\", 0, 30)\n  SETXY(300, 925)\n  PRINT(\"Table of \" + STR$(a%) + \"x + \" + STR$(b%) + \"y\", 0, 40)\n  FOR i% = 1 TO cols%\n    SETXY(i% * colwidth% + xmargin%, ymargin%)\n    PRINT(STR$(i%), 0, fontsize%)\n  NEXT\n  FOR j% = 1 TO rows%\n    SETXY(xmargin%, j% * rowheight% + ymargin%)\n    PRINT(STR$(j%), 0, fontsize%)\n  NEXT\nENDPROC\n\nDEF PROCcalculate\n  LOCAL i%, j%\n  FOR i% = 1 TO cols%\n    FOR j% = 1 TO rows%\n      value%(i%, j%) = a% * i% + b% * j%\n    NEXT\n  NEXT\nENDPROC\n\nDEF PROCdisplay\n  LOCAL i%, j%\n  FOR i% = 1 TO cols%\n    FOR j% = 1 TO rows%\n      SETXY(i% * colwidth% + xmargin%, j% * rowheight% + ymargin%)\n      PRINT(STR$(value%(i%, j%)), 0, fontsize%)\n    NEXT\n  NEXT\nENDPROC\n\nDEF PROCsavedata\n  LOCAL handle%, i%, j%, flag%\n  IF FILEEXISTS(fname$) THEN\n    flag% = DELETEFILE(fname$)\n  ENDIF\n  handle% = OPENOUT(fname$)\n  FOR j% = 1 TO rows%\n    FOR i% = 1 TO cols% - 1\n      PRINT#(handle%, STR$(value%(i%, j%)) + \",\")\n    NEXT\n    PRINTLN#(handle%, STR$(value%(cols%, j%)))\n  NEXT\n  CLOSE#(handle%)\nENDPROC",
  "usage":[
    {
      "category": "Turtle: relative movement",
      "expressions":[
        {"name":"DRAWXY", "level":2, "count":2, "lines":"35 44"}
      ],
      "total":2
    },
    {
      "category": "Turtle: absolute movement",
      "expressions":[
        {"name":"SETXY", "level":1, "count":8, "lines":"34 43 50 52 54 57 61 79"}
      ],
      "total":8
    },
    {
      "category": "Other Turtle commands",
      "expressions":[
        {"name":"THICKNESS", "level":1, "count":4, "lines":"30 32 39 41"}
      ],
      "total":4
    },
    {
      "category": "String operations",
      "expressions":[
        {"name":"PRINT", "level":1, "count":6, "lines":"51 53 55 58 62 80"},
        {"name":"WRITELN", "level":1, "count":1, "lines":"15"}
      ],
      "total":7
    },
    {
      "category": "Type conversion routines",
      "expressions":[
        {"name":"STR$", "level":1, "count":7, "lines":"55 55 58 62 80 93 95"}
      ],
      "total":7
    },
    {
      "category": "File processing",
      "expressions":[
        {"name":"CLOSE#", "level":2, "count":1, "lines":"97"},
        {"name":"DELETEFILE", "level":2, "count":1, "lines":"88"},
        {"name":"OPENOUT", "level":2, "count":1, "lines":"90"},
        {"name":"PRINT#", "level":2, "count":1, "lines":"93"},
        {"name":"PRINTLN#", "level":2, "count":1, "lines":"95"},
        {"name":"FILEEXISTS", "level":3, "count":1, "lines":"87"}
      ],
      "total":6
    },
    {
      "category": "Command structures",
      "expressions":[
        {"name":"IF", "level":1, "count":3, "lines":"29 38 87"},
        {"name":"ELSE", "level":1, "count":2, "lines":"31 40"},
        {"name":"FOR", "level":1, "count":10, "lines":"28 37 56 60 68 69 77 78 91 92"},
        {"name":"DEF PROC", "level":2, "count":6, "lines":"18 26 48 66 75 85"}
      ],
      "total":21
    },
    {
      "category": "Subroutine calls",
      "expressions":[
        {"name":"PROCsetup", "level":0, "count":1, "lines":"9"},
        {"name":"PROCdrawgrid", "level":0, "count":1, "lines":"10"},
        {"name":"PROClabelgrid", "level":0, "count":1, "lines":"11"},
        {"name":"PROCcalculate", "level":0, "count":1, "lines":"12"},
        {"name":"PROCdisplay", "level":0, "count":1, "lines":"13"},
        {"name":"PROCsavedata", "level":0, "count":1, "lines":"14"}
      ],
      "total":6
    }
  ],
  "pcode":[
    [112,18,1,1,112,0,123,112,6,2,123,4,112,156,124,112,174,138],
    [80,112,2,85,112,360,84,112,32,162,112,1,123,141,112,0,1,112,1000,1,1,1,145,144],
    [116,26,119,25],
    [112,11,119,26,116,38,119,27],
    [112,11,119,38,116,50,119,28],
    [112,11,119,50,116,62,119,29],
    [112,11,119,62,116,74,119,30],
    [112,11,119,74,116,86,119,31],
    [112,11,119,86,116,98,119,32],
    [112,11,119,98,116,110,119,33],
    [112,11,119,110,116,122,119,34],
    [112,11,119,122,116,134,119,35],
    [112,11,119,134,116,146,119,36],
    [112,11,119,146,116,158,119,37],
    [112,11,119,158],
    [128,110],
    [133,1],
    [112,1000,112,10,112,1,26,30,119,170],
    [112,900,112,10,112,1,26,30,119,171],
    [113,170,112,3,28,112,7,29,119,172],
    [113,171,112,3,29,119,173],
    [113,170,112,4,29,119,174],
    [134,132],
    [133,2],
    [139,13,2],
    [112,0],
    [120,13,1,112,10,112,1,26],
    [114,13,1,37,129,36],
    [114,13,1,112,0,32,114,13,1,112,1,32,18,114,13,1,112,10,112,1,26,32,18,129,32],
    [112,10,85],
    [128,33],
    [112,2,85],
    [112,5,114,13,1,113,170,28,26,112,5,88],
    [112,0,112,890,90],
    [114,13,1,4,128,27],
    [112,0],
    [120,13,2,112,10,112,1,26],
    [114,13,2,37,129,46],
    [114,13,2,112,0,32,114,13,2,112,1,32,18,114,13,2,112,10,112,1,26,32,18,129,42],
    [112,10,85],
    [128,43],
    [112,2,85],
    [112,5,112,5,114,13,2,113,171,28,26,88],
    [112,995,112,0,90],
    [114,13,2,4,128,37],
    [140,13,134,132],
    [133,3],
    [139,14,2],
    [113,170,112,25,27,112,5,88],
    [118,1,120,112,0,112,30,168,142],
    [112,20,113,171,112,45,27,88],
    [118,1,121,112,0,112,30,168,142],
    [112,300,112,925,88],
    [118,9,84,97,98,108,101,32,111,102,32,112,3,11,64,118,4,120,32,43,32,64,112,4,11,64,118,1,121,64,112,0,112,40,168,142],
    [112,1],
    [120,14,1,112,10],
    [114,14,1,37,129,61],
    [114,14,1,113,170,28,113,172,26,113,173,88],
    [114,14,1,11,112,0,113,174,168,142],
    [114,14,1,4,128,56],
    [112,1],
    [120,14,2,112,10],
    [114,14,2,37,129,67],
    [113,172,114,14,2,113,171,28,113,173,26,88],
    [114,14,2,11,112,0,113,174,168,142],
    [114,14,2,4,128,62],
    [140,14,134,132],
    [133,4],
    [139,15,2],
    [112,1],
    [120,15,1,112,10],
    [114,15,1,37,129,79],
    [112,1],
    [120,15,2,112,10],
    [114,15,2,37,129,78],
    [113,25,114,15,1,2,127,26,4,122,114,15,2,2,127,26,4,112,3,114,15,1,28,112,4,114,15,2,28,26,2,123],
    [114,15,2,4,128,74],
    [114,15,1,4,128,71],
    [140,15,134,132],
    [133,5],
    [139,16,2],
    [112,1],
    [120,16,1,112,10],
    [114,16,1,37,129,92],
    [112,1],
    [120,16,2,112,10],
    [114,16,2,37,129,91],
    [114,16,1,113,170,28,113,172,26,114,16,2,113,171,28,113,173,26,88],
    [113,25,114,16,1,2,127,26,4,122,114,16,2,2,127,26,4,122,11,112,0,113,174,168,142],
    [114,16,2,4,128,86],
    [114,16,1,4,128,83],
    [140,16,134,132],
    [133,6],
    [139,17,4],
    [118,11,83,97,118,101,67,83,86,46,99,115,118,112,0,177,112,127,35,142,129,97],
    [118,11,83,97,118,101,67,83,86,46,99,115,118,112,1,177,112,128,34,120,17,4,142],
    [118,11,83,97,118,101,67,83,86,46,99,115,118,112,3,179,120,17,1,142],
    [112,1],
    [120,17,3,112,10],
    [114,17,3,37,129,108],
    [112,1],
    [120,17,2,112,10,112,1,27],
    [114,17,2,37,129,106],
    [114,17,1,113,25,114,17,2,2,127,26,4,122,114,17,3,2,127,26,4,122,11,118,1,44,64,186,142],
    [114,17,2,4,128,102],
    [114,17,1,113,25,112,10,2,127,26,4,122,114,17,3,2,127,26,4,122,11,187,142],
    [114,17,3,4,128,99],
    [114,17,1,180],
    [140,17,134,132],
    [131,17],
    [131,24],
    [131,47],
    [131,68],
    [131,80],
    [131,93],
    [118,5,70,105,108,101,32,118,11,83,97,118,101,67,83,86,46,99,115,118,64,118,15,32,104,97,115,32,98,101,101,110,32,115,97,118,101,100,64,169,170,142],
    [130]
  ]
}
