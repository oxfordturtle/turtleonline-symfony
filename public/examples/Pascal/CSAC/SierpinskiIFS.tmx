{
  "format":1,
  "language":"Pascal",
  "version":13,
  "name":"SierpinskiIFS",
  "author":"meriv",
  "date":"28/07/2020",
  "time":"08:29:38",
  "code":"PROGRAM SierpinskiIFS;\nCONST xleft = 0;\n      xright = 999;\n      ytop = 0;\n      ybottom = 999;\n      scaledown = 4;\n      mappings = 3;\n      title = 'Sierpinski triangle';\n      live = black;\n      copied = darkgrey;\n      pauseval = 2000;\nVAR xl, xr, yt, yb: integer;\n    coeffdiv: integer;\n    mapxx, mapxy, mapxc: array[1..mappings] of integer;\n    mapyx, mapyy, mapyc: array[1..mappings] of integer;\n    iteration, starttime: integer;\n    count, numborn, numkilled: integer;\n\n  Procedure setmaps;\n  Begin\n    coeffdiv := 100;\n    mapxx[1] := 50;\n    mapyx[1] := 0;\n    mapxy[1] := 0;\n    mapyy[1] := 50;\n    mapxc[1] := 250;\n    mapyc[1] := 0;\n    mapxx[2] := 50;\n    mapyx[2] := 0;\n    mapxy[2] := 0;\n    mapyy[2] := 50;\n    mapxc[2] := 0;\n    mapyc[2] := 500;\n    mapxx[3] := 50;\n    mapyx[3] := 0;\n    mapxy[3] := 0;\n    mapyy[3] := 50;\n    mapxc[3] := 500;\n    mapyc[3] := 500\n  End;\n\n  Procedure setscale;\n  Var i: integer;\n  Begin\n    xl := xleft / scaledown;\n    xr := xright / scaledown;\n    yt := ytop / scaledown;\n    yb := ybottom / scaledown;\n    for i := 1 to mappings do\n      begin\n        mapxc[i] := mapxc[i] / scaledown;\n        mapyc[i] := mapyc[i] / scaledown\n      end\n  End;\n\n  Procedure map(a, x, y: integer; var newx, newy: integer);\n  Begin\n    newx := divmult(x, coeffdiv, mapxx[a]) + divmult(y, coeffdiv, mapxy[a]) + mapxc[a];\n    newy := divmult(x, coeffdiv, mapyx[a]) + divmult(y, coeffdiv, mapyy[a]) + mapyc[a]\n  End;\n\n  Procedure domap(mapnum: integer);\n  Var x, y, newx, newy: integer;\n  Begin\n    noupdate;\n    for y := yt to yb do\n      for x := xl to xr do\n        if pixcol(x, y) <> white then\n          begin\n            map(mapnum, x, y, newx, newy);\n            if pixcol(newx, newy) = white then\n              inc(numborn);\n            pixset(newx, newy, copied)\n          end;\n    update\n  End;\n\n  Procedure cleanup;\n  Var x, y: integer;\n  Begin\n    noupdate;\n    for y := yt to yb do\n      for x := xl to xr do\n        if pixcol(x, y) = live then\n          begin\n            pixset(x, y, white);\n            inc(numkilled)\n          end\n        else\n        if pixcol(x, y) = copied then\n          pixset(x, y, live);\n    update\n  End;\n\nBEGIN\n  setmaps;\n  setscale;\n  canvas(xl, yt, xr - xl + 1, yb - yt + 1);\n  resolution(xr - xl + 1, yb - yt + 1);\n  blank(live);\n  iteration := 0;\n  writeln(title + ' by iterative mapping');\n  timeset(0);\n  repeat\n    starttime := time;\n    inc(iteration);\n    writeln('');\n    writeln('Iteration ' + str(iteration) + ':');\n    numborn := 0;\n    for count := 1 to mappings do\n      domap(count);\n    numkilled := 0;\n    cleanup;\n    writeln('  ' + str(numborn) + ' pixels born; ' + str(numkilled) + ' pixels killed');\n    writeln('  (took ' + str((time - starttime) / 1000) + ' seconds - total ' + str(time / 1000) + ' seconds so far)');\n    if (numborn + numkilled > 0) and (pauseval >= 1000) then\n      begin\n        write('  (now pausing ' + qstr(pauseval, 1000, 1) + ' seconds to allow halting if desired ...)');\n        pause(pauseval);\n        writeln('')\n      end\n  until numborn + numkilled = 0;\n  writeln('FINISH - fixed point of iterative mapping has been reached')\nEND.\n",
  "usage":[
    {
      "category": "Canvas operations",
      "expressions":[
        {"name":"blank", "level":1, "count":1, "lines":"100"},
        {"name":"noupdate", "level":1, "count":2, "lines":"65 81"},
        {"name":"update", "level":1, "count":2, "lines":"75 92"},
        {"name":"canvas", "level":2, "count":1, "lines":"98"},
        {"name":"resolution", "level":2, "count":1, "lines":"99"},
        {"name":"pixcol", "level":3, "count":4, "lines":"68 71 84 90"},
        {"name":"pixset", "level":3, "count":3, "lines":"73 86 91"}
      ],
      "total":14
    },
    {
      "category": "General arithmetic functions",
      "expressions":[
        {"name":"inc", "level":1, "count":3, "lines":"72 87 106"},
        {"name":"divmult", "level":3, "count":4, "lines":"58 58 59 59"}
      ],
      "total":7
    },
    {
      "category": "String operations",
      "expressions":[
        {"name":"write", "level":1, "count":1, "lines":"118"},
        {"name":"writeln", "level":1, "count":7, "lines":"102 107 108 114 115 120 123"}
      ],
      "total":8
    },
    {
      "category": "Type conversion routines",
      "expressions":[
        {"name":"str", "level":1, "count":5, "lines":"108 114 114 115 115"},
        {"name":"qstr", "level":2, "count":1, "lines":"118"}
      ],
      "total":6
    },
    {
      "category": "Input and timing routines",
      "expressions":[
        {"name":"pause", "level":1, "count":1, "lines":"119"},
        {"name":"time", "level":2, "count":3, "lines":"105 115 115"},
        {"name":"timeset", "level":2, "count":1, "lines":"103"}
      ],
      "total":5
    },
    {
      "category": "Command structures",
      "expressions":[
        {"name":"if", "level":1, "count":5, "lines":"68 71 84 90 116"},
        {"name":"else", "level":1, "count":1, "lines":"89"},
        {"name":"for", "level":1, "count":6, "lines":"49 66 67 82 83 110"},
        {"name":"repeat", "level":2, "count":1, "lines":"104"},
        {"name":"procedure", "level":2, "count":5, "lines":"19 42 56 62 78"}
      ],
      "total":18
    },
    {
      "category": "Subroutine calls",
      "expressions":[
        {"name":"map", "level":0, "count":1, "lines":"70"},
        {"name":"setmaps", "level":0, "count":1, "lines":"96"},
        {"name":"setscale", "level":0, "count":1, "lines":"97"},
        {"name":"domap", "level":0, "count":1, "lines":"111"},
        {"name":"cleanup", "level":0, "count":1, "lines":"113"}
      ],
      "total":5
    }
  ],
  "pcode":[
    [112,17,1,1,112,0,123,112,6,2,123,4,112,46,124,112,63,138],
    [80,112,2,85,112,360,84,112,32,162,112,1,123,141,112,0,1,112,1000,1,1,1,145,144],
    [116,30,119,29],
    [112,3,119,30],
    [116,35,119,34],
    [112,3,119,35],
    [116,40,119,39],
    [112,3,119,40],
    [116,45,119,44],
    [112,3,119,45],
    [116,50,119,49],
    [112,3,119,50],
    [116,55,119,54],
    [112,3,119,55],
    [128,96],
    [133,1],
    [112,100,119,28],
    [113,29,112,1,112,1,27,2,127,26,4,112,50,2,123],
    [113,44,112,1,112,1,27,2,127,26,4,112,0,2,123],
    [113,34,112,1,112,1,27,2,127,26,4,112,0,2,123],
    [113,49,112,1,112,1,27,2,127,26,4,112,50,2,123],
    [113,39,112,1,112,1,27,2,127,26,4,112,250,2,123],
    [113,54,112,1,112,1,27,2,127,26,4,112,0,2,123],
    [113,29,112,2,112,1,27,2,127,26,4,112,50,2,123],
    [113,44,112,2,112,1,27,2,127,26,4,112,0,2,123],
    [113,34,112,2,112,1,27,2,127,26,4,112,0,2,123],
    [113,49,112,2,112,1,27,2,127,26,4,112,50,2,123],
    [113,39,112,2,112,1,27,2,127,26,4,112,0,2,123],
    [113,54,112,2,112,1,27,2,127,26,4,112,500,2,123],
    [113,29,112,3,112,1,27,2,127,26,4,112,50,2,123],
    [113,44,112,3,112,1,27,2,127,26,4,112,0,2,123],
    [113,34,112,3,112,1,27,2,127,26,4,112,0,2,123],
    [113,49,112,3,112,1,27,2,127,26,4,112,50,2,123],
    [113,39,112,3,112,1,27,2,127,26,4,112,500,2,123],
    [113,54,112,3,112,1,27,2,127,26,4,112,500,2,123],
    [134,132],
    [133,2],
    [139,13,1],
    [117,13,1,112,1,124],
    [112,0,112,4,29,119,24],
    [112,999,112,4,29,119,25],
    [112,0,112,4,29,119,26],
    [112,999,112,4,29,119,27],
    [112,1],
    [120,13,1,112,3],
    [114,13,1,37,129,50],
    [113,39,114,13,1,112,1,27,2,127,26,4,113,39,114,13,1,112,1,27,2,127,26,4,122,112,4,29,2,123],
    [113,54,114,13,1,112,1,27,2,127,26,4,113,54,114,13,1,112,1,27,2,127,26,4,122,112,4,29,2,123],
    [114,13,1,4,128,45],
    [140,13,134,132],
    [133,3],
    [139,14,5],
    [117,14,1,112,5,124,120,14,5,120,14,4,120,14,3,120,14,2,120,14,1],
    [114,14,2,113,28,113,29,114,14,1,112,1,27,2,127,26,4,122,48,114,14,3,113,28,113,34,114,14,1,112,1,27,2,127,26,4,122,48,26,113,39,114,14,1,112,1,27,2,127,26,4,122,26,121,14,4],
    [114,14,2,113,28,113,44,114,14,1,112,1,27,2,127,26,4,122,48,114,14,3,113,28,113,49,114,14,1,112,1,27,2,127,26,4,122,48,26,113,54,114,14,1,112,1,27,2,127,26,4,122,26,121,14,5],
    [140,14,134,132],
    [133,4],
    [139,15,5],
    [117,15,1,112,5,124,120,15,1],
    [112,0,146],
    [113,26],
    [120,15,3,113,27],
    [114,15,3,37,129,74],
    [113,24],
    [120,15,2,113,25],
    [114,15,2,37,129,73],
    [114,15,2,114,15,3,99,112,16777215,33,129,72],
    [114,15,1,114,15,2,114,15,3,117,15,4,117,15,5,131,51],
    [114,15,4,114,15,5,99,112,16777215,32,129,71],
    [116,62,1,122,4,2,123],
    [114,15,4,114,15,5,112,4210752,100],
    [114,15,2,4,128,65],
    [114,15,3,4,128,62],
    [112,-1,146],
    [140,15,134,132],
    [133,5],
    [139,16,2],
    [117,16,1,112,2,124],
    [112,0,146],
    [113,26],
    [120,16,2,113,27],
    [114,16,2,37,129,94],
    [113,24],
    [120,16,1,113,25],
    [114,16,1,37,129,93],
    [114,16,1,114,16,2,99,112,0,32,129,90],
    [114,16,1,114,16,2,112,16777215,100],
    [116,63,1,122,4,2,123],
    [128,92],
    [114,16,1,114,16,2,99,112,4210752,32,129,92],
    [114,16,1,114,16,2,112,0,100],
    [114,16,1,4,128,84],
    [114,16,2,4,128,81],
    [112,-1,146],
    [140,16,134,132],
    [131,16],
    [131,37],
    [113,24,113,26,113,25,113,24,27,112,1,26,113,27,113,26,27,112,1,26,144],
    [113,25,113,24,27,112,1,26,113,27,113,26,27,112,1,26,145],
    [112,0,96],
    [112,0,119,59],
    [118,19,83,105,101,114,112,105,110,115,107,105,32,116,114,105,97,110,103,108,101,118,21,32,98,121,32,105,116,101,114,97,116,105,118,101,32,109,97,112,112,105,110,103,64,169,170,142],
    [112,0,173],
    [172,119,60],
    [116,59,1,122,4,2,123],
    [118,0,169,170,142],
    [118,10,73,116,101,114,97,116,105,111,110,32,113,59,11,64,112,58,9,64,169,170,142],
    [112,0,119,62],
    [112,1],
    [119,61,112,3],
    [113,61,37,129,114],
    [113,61,131,57],
    [113,61,4,128,110],
    [112,0,119,63],
    [131,76],
    [118,2,32,32,113,62,11,64,118,14,32,112,105,120,101,108,115,32,98,111,114,110,59,32,64,113,63,11,64,118,14,32,112,105,120,101,108,115,32,107,105,108,108,101,100,64,169,170,142],
    [118,8,32,32,40,116,111,111,107,32,172,113,60,27,112,1000,29,11,64,118,17,32,115,101,99,111,110,100,115,32,45,32,116,111,116,97,108,32,64,172,112,1000,29,11,64,118,16,32,115,101,99,111,110,100,115,32,115,111,32,102,97,114,41,64,169,170,142],
    [113,62,113,63,26,112,0,35,112,2000,112,1000,37,17,129,122],
    [118,15,32,32,40,110,111,119,32,112,97,117,115,105,110,103,32,112,2000,112,1000,112,1,14,64,118,41,32,115,101,99,111,110,100,115,32,116,111,32,97,108,108,111,119,32,104,97,108,116,105,110,103,32,105,102,32,100,101,115,105,114,101,100,32,46,46,46,41,64,169,142],
    [112,2000,174],
    [118,0,169,170,142],
    [113,62,113,63,26,112,0,32,129,104],
    [118,58,70,73,78,73,83,72,32,45,32,102,105,120,101,100,32,112,111,105,110,116,32,111,102,32,105,116,101,114,97,116,105,118,101,32,109,97,112,112,105,110,103,32,104,97,115,32,98,101,101,110,32,114,101,97,99,104,101,100,169,170,142],
    [130]
  ]
}
