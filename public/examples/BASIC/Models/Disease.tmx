{
  "format":1,
  "language":"BASIC",
  "version":13,
  "name":"Spread of disease",
  "author":"Peter Millican",
  "date":"23/07/2020",
  "time":"12:00:29",
  "code":"REM Disease\n\nCONST WIDTH% = 100\nCONST HEIGHT% = 100\nCONST SUSCEPTIBLE% = LIGHTGREEN\nCONST INFECTED% = RED\nCONST RECOVERED% = BLUE\nCONST STARTRADIUS% = 10\nCONST INFECTPROB% = 1\nCONST IMMUNEPROB% = 2\nCONST RECOVERPROB% = 15\nCANVAS(0, 0, WIDTH%, HEIGHT%)\nRESOLUTION(WIDTH%, HEIGHT%)\nnuminfected% = 0\nNOUPDATE\nFOR x% = 0 TO WIDTH% - 1\n  FOR y% = 0 TO HEIGHT% - 1\n    IF (RND(100) - 1 < INFECTPROB%) AND (HYPOT(x% - WIDTH% / 2, y% - HEIGHT% / 2, 1) <= STARTRADIUS%) THEN\n      PROCinfect(x%, y%)\n    ELSE\n      IF RND(100) - 1 < IMMUNEPROB% THEN\n        PIXSET(x%, y%, RECOVERED%)\n      ELSE\n        PIXSET(x%, y%, SUSCEPTIBLE%)\n      ENDIF\n    ENDIF\n  NEXT\nNEXT\nUPDATE\nREPEAT\n  x% = RND(WIDTH%) - 1\n  y% = RND(HEIGHT%) - 1\n  IF PIXCOL(x%, y%) = INFECTED% THEN\n    IF RND(100) - 1 < RECOVERPROB% THEN\n      PIXSET(x%, y%, RECOVERED%)\n      DEC(numinfected%)\n    ELSE\n      n% = (RND(4) - 1) * 2 + 1\n      x% = x% + n% DIV 3 - 1\n      y% = y% + n% MOD 3 - 1\n      IF PIXCOL(x%, y%) = SUSCEPTIBLE% THEN PROCinfect(x%, y%)\n    ENDIF\n  ENDIF\nUNTIL numinfected% = 0\nEND\n\nDEF PROCinfect(x%, y%)\n  PIXSET(x%, y%, INFECTED%)\n  INC(numinfected%)\nENDPROC",
  "usage":[
    {
      "category": "Canvas operations",
      "expressions":[
        {"name":"NOUPDATE", "level":1, "count":1, "lines":"15"},
        {"name":"UPDATE", "level":1, "count":1, "lines":"29"},
        {"name":"CANVAS", "level":2, "count":1, "lines":"12"},
        {"name":"RESOLUTION", "level":2, "count":1, "lines":"13"},
        {"name":"PIXCOL", "level":3, "count":2, "lines":"33 41"},
        {"name":"PIXSET", "level":3, "count":4, "lines":"48 22 24 35"}
      ],
      "total":10
    },
    {
      "category": "General arithmetic functions",
      "expressions":[
        {"name":"DEC", "level":1, "count":1, "lines":"36"},
        {"name":"INC", "level":1, "count":1, "lines":"49"},
        {"name":"HYPOT", "level":2, "count":1, "lines":"18"},
        {"name":"RND", "level":2, "count":6, "lines":"18 21 31 32 34 38"}
      ],
      "total":9
    },
    {
      "category": "Command structures",
      "expressions":[
        {"name":"IF", "level":1, "count":5, "lines":"18 21 33 34 41"},
        {"name":"ELSE", "level":1, "count":3, "lines":"20 23 37"},
        {"name":"FOR", "level":1, "count":2, "lines":"16 17"},
        {"name":"REPEAT", "level":2, "count":1, "lines":"30"},
        {"name":"DEF PROC", "level":2, "count":1, "lines":"47"}
      ],
      "total":12
    },
    {
      "category": "Subroutine calls",
      "expressions":[
        {"name":"PROCinfect", "level":0, "count":2, "lines":"19 41"}
      ],
      "total":2
    }
  ],
  "pcode":[
    [112,13,1,1,112,0,123,112,6,2,123,4,112,10,124,112,23,138],
    [80,112,2,85,112,360,84,112,32,162,112,1,123,141,112,0,1,112,1000,1,1,1,145,144],
    [128,10],
    [133,1],
    [139,12,2],
    [117,12,1,112,2,124,120,12,2,120,12,1],
    [114,12,1,114,12,2,112,16711680,100],
    [116,20,1,122,4,2,123],
    [140,12,134,132],
    [112,0,112,0,112,100,112,100,144],
    [112,100,112,100,145],
    [112,0,119,20],
    [112,0,146],
    [112,0],
    [119,21,112,100,112,1,27],
    [113,21,37,129,29],
    [112,0],
    [119,22,112,100,112,1,27],
    [113,22,37,129,28],
    [112,100,7,4,112,1,27,112,1,34,113,21,112,100,112,2,29,27,113,22,112,100,112,2,29,27,112,1,50,112,10,36,17,129,23],
    [113,21,113,22,131,4],
    [128,27],
    [112,100,7,4,112,1,27,112,2,34,129,26],
    [113,21,113,22,112,255,100],
    [128,27],
    [113,21,113,22,112,10025880,100],
    [113,22,4,128,18],
    [113,21,4,128,15],
    [112,-1,146],
    [112,100,7,4,112,1,27,119,21],
    [112,100,7,4,112,1,27,119,22],
    [113,21,113,22,99,112,16711680,32,129,42],
    [112,100,7,4,112,1,27,112,15,34,129,37],
    [113,21,113,22,112,255,100],
    [116,20,1,122,5,2,123],
    [128,42],
    [112,4,7,4,112,1,27,112,2,28,112,1,26,119,23],
    [113,21,113,23,112,3,30,26,112,1,27,119,21],
    [113,22,113,23,112,3,31,26,112,1,27,119,22],
    [113,21,113,22,99,112,10025880,32,129,42],
    [113,21,113,22,131,4],
    [113,20,112,0,32,129,30],
    [130]
  ]
}
