{
  "format":1,
  "language":"BASIC",
  "version":13,
  "name":"IFS mappings on coloured background",
  "author":"Peter Millican",
  "date":"28/07/2020",
  "time":"13:25:42",
  "code":"REM IFScolour\n\nCONST MAXMAPPINGS%=4\nDIM mapxx%(MAXMAPPINGS%)\nDIM mapxy%(MAXMAPPINGS%)\nDIM mapxc%(MAXMAPPINGS%)\nDIM mapyx%(MAXMAPPINGS%)\nDIM mapyy%(MAXMAPPINGS%)\nDIM mapyc%(MAXMAPPINGS%)\nPROCstartprompt\nPROCsetscale\nCANVAS(xl%,yt%,xr%-xl%+1,yb%-yt%+1)\nRESOLUTION(xr%-xl%+1,yb%-yt%+1)\nPROCbackground\nFOR count%=1 TO mappings%\n PROCdomap(count%)\nNEXT\nEND\n\nDEF PROCsetsierpinski\n xleft%=0\n xright%=999\n ytop%=0\n ybottom%=999\n scaledown%=2\n mappings%=3\n gridscale%=5\n gridthick%=64\n coeffdiv%=100\n mapxx%(1)=50\n mapyx%(1)=0\n mapxy%(1)=0\n mapyy%(1)=50\n mapxc%(1)=250\n mapyc%(1)=0\n mapxx%(2)=50\n mapyx%(2)=0\n mapxy%(2)=0\n mapyy%(2)=50\n mapxc%(2)=0\n mapyc%(2)=500\n mapxx%(3)=50\n mapyx%(3)=0\n mapxy%(3)=0\n mapyy%(3)=50\n mapxc%(3)=500\n mapyc%(3)=500\nENDPROC\n\nDEF PROCsetbarnsley\n xleft%=-236\n xright%=263\n ytop%=1\n ybottom%=1000\n scaledown%=2\n mappings%=4\n gridscale%=5\n gridthick%=32\n coeffdiv%=100\n mapxx%(1)=0\n mapyx%(1)=0\n mapxy%(1)=0\n mapyy%(1)=16\n mapxc%(1)=0\n mapyc%(1)=0\n mapxx%(2)=85\n mapyx%(2)=-4\n mapxy%(2)=4\n mapyy%(2)=85\n mapxc%(2)=0\n mapyc%(2)=160\n mapxx%(3)=20\n mapyx%(3)=23\n mapxy%(3)=-26\n mapyy%(3)=22\n mapxc%(3)=0\n mapyc%(3)=160\n mapxx%(4)=-15\n mapyx%(4)=26\n mapxy%(4)=28\n mapyy%(4)=24\n mapxc%(4)=0\n mapyc%(4)=44\nENDPROC\n\nDEF PROCsetdragon\n xleft%=0\n xright%=999\n ytop%=0\n ybottom%=999\n scaledown%=4\n mappings%=3\n gridscale%=5\n gridthick%=64\n coeffdiv%=1000\n mapxx%(1)=0\n mapyx%(1)=-577\n mapxy%(1)=577\n mapyy%(1)=0\n mapxc%(1)=95\n mapyc%(1)=589\n mapxx%(2)=0\n mapyx%(2)=-577\n mapxy%(2)=577\n mapyy%(2)=0\n mapxc%(2)=441\n mapyc%(2)=789\n mapxx%(3)=0\n mapyx%(3)=-577\n mapxy%(3)=577\n mapyy%(3)=0\n mapxc%(3)=95\n mapyc%(3)=989\nENDPROC\n\nDEF PROCstartprompt\n OUTPUT(TRUE,CREAM,TRUE)\n KEYECHO(FALSE)\n WRITELN(\"ITERATED FUNCTIONS ON COLOURED BACKGROUND\")\n WRITELN(\"\")\n WRITE(\"Select Sierpinski, Barnsley fern, or Dragon curve? (S/B/D) \")\n KEYECHO(FALSE)\n REPEAT\n UNTIL (ABS(?KEY)=\\s) OR (ABS(?KEY)=\\b) OR (ABS(?KEY)=\\d)\n WRITELN(CHR$(ABS(?KEY)))\n IF ABS(?KEY)=\\s THEN\n  WRITELN(\"Sierpinski mappings will be used\")\n  PROCsetsierpinski\n ELSE\n  IF ABS(?KEY)=\\b THEN\n   WRITELN(\"Barnsley fern mappings will be used\")\n   PROCsetbarnsley\n  ELSE\n   WRITELN(\"Dragon curve mappings will be used\")\n   PROCsetdragon\n  ENDIF\n ENDIF\n OUTPUT(FALSE,WHITE,FALSE)\nENDPROC\n\nDEF PROCsetscale\n xl%=xleft%/scaledown%\n xr%=xright%/scaledown%\n yt%=ytop%/scaledown%\n yb%=ybottom%/scaledown%\n FOR i%=1 TO mappings%\n  mapxc%(i%)=mapxc%(i%)/scaledown%\n  mapyc%(i%)=mapyc%(i%)/scaledown%\n NEXT\n gt%=gridthick%/scaledown%\nENDPROC\n\nDEF PROCbackground\n LOCAL x%,y%\n LOCAL cx%,cy%,r%,g%,b%\n THICKNESS(gt%)\n COLOUR(DARKGREY)\n FOR x%=1 TO gridscale%-1\n  SETXY(xl%+DIVMULT(xr%-xl%,gridscale%,x%),yt%)\n  DRAWXY(0,yb%-yt%)\n NEXT\n FOR y%=1 TO gridscale%-1\n  SETXY(xl%+gt%/2,yt%+DIVMULT(yb%-yt%,gridscale%,y%))\n  DRAWXY(xr%-xl%-gt%,0)\n NEXT\n COLOUR(BLACK)\n SETXY(xl%,yt%)\n DRAWXY(xr%-xl%,0)\n DRAWXY(0,yb%-yt%)\n DRAWXY(xl%-xr%,0)\n DRAWXY(0,yt%-yb%)\n FOR x%=0 TO gridscale%-1\n  FOR y%=0 TO gridscale%-1\n   cx%=xl%+DIVMULT(xr%-xl%,gridscale%,x%)+gt%\n   cy%=yt%+DIVMULT(yb%-yt%,gridscale%,y%)+gt%\n   r%=DIVMULT(255,gridscale%-1,x%)\n   g%=DIVMULT(255,gridscale%-1,y%)\n   b%=DIVMULT(255,2*gridscale%-2,2*gridscale%-2-x%-y%)\n   RECOLOUR(cx%,cy%,(r%*&10000)+(g%*&100)+(b%*&1))\n  NEXT\n NEXT\nENDPROC\n\nDEF PROCmap(a%,x%,y%,RETURN newx%,RETURN newy%)\n newx%=DIVMULT(x%,coeffdiv%,mapxx%(a%))+DIVMULT(y%,coeffdiv%,mapxy%(a%))+mapxc%(a%)\n newy%=DIVMULT(x%,coeffdiv%,mapyx%(a%))+DIVMULT(y%,coeffdiv%,mapyy%(a%))+mapyc%(a%)\nENDPROC\n\nDEF PROCdomap(mapnum%)\n LOCAL x%,y%,newx%,newy%\n NOUPDATE\n FOR y%=yt% TO yb%\n  FOR x%=xl% TO xr%\n   PROCmap(mapnum%,x%,y%,newx%,newy%)\n   PIXSET(newx%,newy%,PIXCOL(x%,y%))\n  NEXT\n NEXT\n UPDATE\nENDPROC",
  "usage":[
    {
      "category": "Turtle: relative movement",
      "expressions":[
        {"name":"DRAWXY", "level":2, "count":6, "lines":"160 164 168 169 170 171"}
      ],
      "total":6
    },
    {
      "category": "Turtle: absolute movement",
      "expressions":[
        {"name":"SETXY", "level":1, "count":3, "lines":"159 163 167"}
      ],
      "total":3
    },
    {
      "category": "Other Turtle commands",
      "expressions":[
        {"name":"COLOUR", "level":1, "count":2, "lines":"157 166"},
        {"name":"THICKNESS", "level":1, "count":1, "lines":"156"},
        {"name":"OUTPUT", "level":2, "count":2, "lines":"117 138"}
      ],
      "total":5
    },
    {
      "category": "Canvas operations",
      "expressions":[
        {"name":"NOUPDATE", "level":1, "count":1, "lines":"191"},
        {"name":"UPDATE", "level":1, "count":1, "lines":"198"},
        {"name":"CANVAS", "level":2, "count":1, "lines":"12"},
        {"name":"RESOLUTION", "level":2, "count":1, "lines":"13"},
        {"name":"PIXCOL", "level":3, "count":1, "lines":"195"},
        {"name":"PIXSET", "level":3, "count":1, "lines":"195"},
        {"name":"RECOLOUR", "level":3, "count":1, "lines":"179"}
      ],
      "total":7
    },
    {
      "category": "General arithmetic functions",
      "expressions":[
        {"name":"ABS", "level":1, "count":6, "lines":"124 124 124 125 126 130"},
        {"name":"DIVMULT", "level":3, "count":11, "lines":"159 163 174 175 176 177 178 185 185 186 186"}
      ],
      "total":17
    },
    {
      "category": "String operations",
      "expressions":[
        {"name":"WRITE", "level":1, "count":1, "lines":"121"},
        {"name":"WRITELN", "level":1, "count":6, "lines":"119 120 125 127 131 134"}
      ],
      "total":7
    },
    {
      "category": "Type conversion routines",
      "expressions":[
        {"name":"CHR$", "level":3, "count":1, "lines":"125"}
      ],
      "total":1
    },
    {
      "category": "Input and timing routines",
      "expressions":[
        {"name":"KEYECHO", "level":2, "count":2, "lines":"118 122"}
      ],
      "total":2
    },
    {
      "category": "Command structures",
      "expressions":[
        {"name":"IF", "level":1, "count":2, "lines":"126 130"},
        {"name":"ELSE", "level":1, "count":2, "lines":"129 133"},
        {"name":"FOR", "level":1, "count":8, "lines":"146 158 162 172 173 192 193 15"},
        {"name":"REPEAT", "level":2, "count":1, "lines":"123"},
        {"name":"DEF PROC", "level":2, "count":8, "lines":"20 50 86 116 141 153 184 189"}
      ],
      "total":21
    },
    {
      "category": "Subroutine calls",
      "expressions":[
        {"name":"PROCsetsierpinski", "level":0, "count":1, "lines":"128"},
        {"name":"PROCsetbarnsley", "level":0, "count":1, "lines":"132"},
        {"name":"PROCsetdragon", "level":0, "count":1, "lines":"135"},
        {"name":"PROCmap", "level":0, "count":1, "lines":"194"},
        {"name":"PROCstartprompt", "level":0, "count":1, "lines":"10"},
        {"name":"PROCsetscale", "level":0, "count":1, "lines":"11"},
        {"name":"PROCbackground", "level":0, "count":1, "lines":"14"},
        {"name":"PROCdomap", "level":0, "count":1, "lines":"16"}
      ],
      "total":8
    }
  ],
  "pcode":[
    [112,20,1,1,112,0,123,112,6,2,123,4,112,64,124,112,84,138],
    [80,112,2,85,112,360,84,112,32,162,112,1,123,141,112,0,1,112,1000,1,1,1,145,144],
    [116,28,119,27],
    [112,5,119,28],
    [116,35,119,34],
    [112,5,119,35],
    [116,42,119,41],
    [112,5,119,42],
    [116,49,119,48],
    [112,5,119,49],
    [116,56,119,55],
    [112,5,119,56],
    [116,63,119,62],
    [112,5,119,63],
    [128,203],
    [133,1],
    [112,0,119,70],
    [112,999,119,71],
    [112,0,119,72],
    [112,999,119,73],
    [112,2,119,74],
    [112,3,119,75],
    [112,5,119,76],
    [112,64,119,77],
    [112,100,119,78],
    [113,27,112,1,2,127,26,4,112,50,2,123],
    [113,48,112,1,2,127,26,4,112,0,2,123],
    [113,34,112,1,2,127,26,4,112,0,2,123],
    [113,55,112,1,2,127,26,4,112,50,2,123],
    [113,41,112,1,2,127,26,4,112,250,2,123],
    [113,62,112,1,2,127,26,4,112,0,2,123],
    [113,27,112,2,2,127,26,4,112,50,2,123],
    [113,48,112,2,2,127,26,4,112,0,2,123],
    [113,34,112,2,2,127,26,4,112,0,2,123],
    [113,55,112,2,2,127,26,4,112,50,2,123],
    [113,41,112,2,2,127,26,4,112,0,2,123],
    [113,62,112,2,2,127,26,4,112,500,2,123],
    [113,27,112,3,2,127,26,4,112,50,2,123],
    [113,48,112,3,2,127,26,4,112,0,2,123],
    [113,34,112,3,2,127,26,4,112,0,2,123],
    [113,55,112,3,2,127,26,4,112,50,2,123],
    [113,41,112,3,2,127,26,4,112,500,2,123],
    [113,62,112,3,2,127,26,4,112,500,2,123],
    [134,132],
    [133,2],
    [112,236,23,119,70],
    [112,263,119,71],
    [112,1,119,72],
    [112,1000,119,73],
    [112,2,119,74],
    [112,4,119,75],
    [112,5,119,76],
    [112,32,119,77],
    [112,100,119,78],
    [113,27,112,1,2,127,26,4,112,0,2,123],
    [113,48,112,1,2,127,26,4,112,0,2,123],
    [113,34,112,1,2,127,26,4,112,0,2,123],
    [113,55,112,1,2,127,26,4,112,16,2,123],
    [113,41,112,1,2,127,26,4,112,0,2,123],
    [113,62,112,1,2,127,26,4,112,0,2,123],
    [113,27,112,2,2,127,26,4,112,85,2,123],
    [113,48,112,2,2,127,26,4,112,4,23,2,123],
    [113,34,112,2,2,127,26,4,112,4,2,123],
    [113,55,112,2,2,127,26,4,112,85,2,123],
    [113,41,112,2,2,127,26,4,112,0,2,123],
    [113,62,112,2,2,127,26,4,112,160,2,123],
    [113,27,112,3,2,127,26,4,112,20,2,123],
    [113,48,112,3,2,127,26,4,112,23,2,123],
    [113,34,112,3,2,127,26,4,112,26,23,2,123],
    [113,55,112,3,2,127,26,4,112,22,2,123],
    [113,41,112,3,2,127,26,4,112,0,2,123],
    [113,62,112,3,2,127,26,4,112,160,2,123],
    [113,27,112,4,2,127,26,4,112,15,23,2,123],
    [113,48,112,4,2,127,26,4,112,26,2,123],
    [113,34,112,4,2,127,26,4,112,28,2,123],
    [113,55,112,4,2,127,26,4,112,24,2,123],
    [113,41,112,4,2,127,26,4,112,0,2,123],
    [113,62,112,4,2,127,26,4,112,44,2,123],
    [134,132],
    [133,3],
    [112,0,119,70],
    [112,999,119,71],
    [112,0,119,72],
    [112,999,119,73],
    [112,4,119,74],
    [112,3,119,75],
    [112,5,119,76],
    [112,64,119,77],
    [112,1000,119,78],
    [113,27,112,1,2,127,26,4,112,0,2,123],
    [113,48,112,1,2,127,26,4,112,577,23,2,123],
    [113,34,112,1,2,127,26,4,112,577,2,123],
    [113,55,112,1,2,127,26,4,112,0,2,123],
    [113,41,112,1,2,127,26,4,112,95,2,123],
    [113,62,112,1,2,127,26,4,112,589,2,123],
    [113,27,112,2,2,127,26,4,112,0,2,123],
    [113,48,112,2,2,127,26,4,112,577,23,2,123],
    [113,34,112,2,2,127,26,4,112,577,2,123],
    [113,55,112,2,2,127,26,4,112,0,2,123],
    [113,41,112,2,2,127,26,4,112,441,2,123],
    [113,62,112,2,2,127,26,4,112,789,2,123],
    [113,27,112,3,2,127,26,4,112,0,2,123],
    [113,48,112,3,2,127,26,4,112,577,23,2,123],
    [113,34,112,3,2,127,26,4,112,577,2,123],
    [113,55,112,3,2,127,26,4,112,0,2,123],
    [113,41,112,3,2,127,26,4,112,95,2,123],
    [113,62,112,3,2,127,26,4,112,989,2,123],
    [134,132],
    [133,4],
    [112,-1,112,16777147,112,-1,166],
    [112,0,165],
    [118,41,73,84,69,82,65,84,69,68,32,70,85,78,67,84,73,79,78,83,32,79,78,32,67,79,76,79,85,82,69,68,32,66,65,67,75,71,82,79,85,78,68,169,170,142],
    [118,0,169,170,142],
    [118,59,83,101,108,101,99,116,32,83,105,101,114,112,105,110,115,107,105,44,32,66,97,114,110,115,108,101,121,32,102,101,114,110,44,32,111,114,32,68,114,97,103,111,110,32,99,117,114,118,101,63,32,40,83,47,66,47,68,41,32,169,142],
    [112,0,165],
    [112,-9,160,24,112,83,32,112,-9,160,24,112,66,32,18,112,-9,160,24,112,68,32,18,129,116],
    [112,-9,160,24,9,169,170,142],
    [112,-9,160,24,112,83,32,129,122],
    [118,32,83,105,101,114,112,105,110,115,107,105,32,109,97,112,112,105,110,103,115,32,119,105,108,108,32,98,101,32,117,115,101,100,169,170,142],
    [131,16],
    [128,128],
    [112,-9,160,24,112,66,32,129,126],
    [118,35,66,97,114,110,115,108,101,121,32,102,101,114,110,32,109,97,112,112,105,110,103,115,32,119,105,108,108,32,98,101,32,117,115,101,100,169,170,142],
    [131,45],
    [128,128],
    [118,34,68,114,97,103,111,110,32,99,117,114,118,101,32,109,97,112,112,105,110,103,115,32,119,105,108,108,32,98,101,32,117,115,101,100,169,170,142],
    [131,80],
    [112,0,112,16777215,112,0,166],
    [134,132],
    [133,5],
    [113,70,113,74,29,119,79],
    [113,71,113,74,29,119,80],
    [113,72,113,74,29,119,81],
    [113,73,113,74,29,119,82],
    [112,1],
    [119,83,113,75],
    [113,83,37,129,141],
    [113,41,113,83,2,127,26,4,113,41,113,83,2,127,26,4,122,113,74,29,2,123],
    [113,62,113,83,2,127,26,4,113,62,113,83,2,127,26,4,122,113,74,29,2,123],
    [113,83,4,128,136],
    [113,77,113,74,29,119,84],
    [134,132],
    [133,6],
    [139,17,7],
    [117,17,1,112,7,124],
    [113,84,85],
    [112,4210752,87],
    [112,1],
    [120,17,1,113,76,112,1,27],
    [114,17,1,37,129,154],
    [113,79,113,80,113,79,27,113,76,114,17,1,48,26,113,81,88],
    [112,0,113,82,113,81,27,90],
    [114,17,1,4,128,149],
    [112,1],
    [120,17,2,113,76,112,1,27],
    [114,17,2,37,129,160],
    [113,79,113,84,112,2,29,26,113,81,113,82,113,81,27,113,76,114,17,2,48,26,88],
    [113,80,113,79,27,113,84,27,112,0,90],
    [114,17,2,4,128,155],
    [112,0,87],
    [113,79,113,81,88],
    [113,80,113,79,27,112,0,90],
    [112,0,113,82,113,81,27,90],
    [113,79,113,80,27,112,0,90],
    [112,0,113,81,113,82,27,90],
    [112,0],
    [120,17,1,113,76,112,1,27],
    [114,17,1,37,129,180],
    [112,0],
    [120,17,2,113,76,112,1,27],
    [114,17,2,37,129,179],
    [113,79,113,80,113,79,27,113,76,114,17,1,48,26,113,84,26,120,17,3],
    [113,81,113,82,113,81,27,113,76,114,17,2,48,26,113,84,26,120,17,4],
    [112,255,113,76,112,1,27,114,17,1,48,120,17,5],
    [112,255,113,76,112,1,27,114,17,2,48,120,17,6],
    [112,255,112,2,113,76,28,112,2,27,112,2,113,76,28,112,2,27,114,17,1,27,114,17,2,27,48,120,17,7],
    [114,17,3,114,17,4,114,17,5,112,65536,28,114,17,6,112,256,28,26,114,17,7,112,1,28,26,97],
    [114,17,2,4,128,170],
    [114,17,1,4,128,167],
    [140,17,134,132],
    [133,7],
    [139,18,5],
    [117,18,1,112,5,124,120,18,5,120,18,4,120,18,3,120,18,2,120,18,1],
    [114,18,2,113,78,113,27,114,18,1,2,127,26,4,122,48,114,18,3,113,78,113,34,114,18,1,2,127,26,4,122,48,26,113,41,114,18,1,2,127,26,4,122,26,121,18,4],
    [114,18,2,113,78,113,48,114,18,1,2,127,26,4,122,48,114,18,3,113,78,113,55,114,18,1,2,127,26,4,122,48,26,113,62,114,18,1,2,127,26,4,122,26,121,18,5],
    [140,18,134,132],
    [133,8],
    [139,19,5],
    [117,19,1,112,5,124,120,19,1],
    [112,0,146],
    [113,81],
    [120,19,3,113,82],
    [114,19,3,37,129,201],
    [113,79],
    [120,19,2,113,80],
    [114,19,2,37,129,200],
    [114,19,1,114,19,2,114,19,3,117,19,4,117,19,5,131,181],
    [114,19,4,114,19,5,114,19,2,114,19,3,99,100],
    [114,19,2,4,128,195],
    [114,19,3,4,128,192],
    [112,-1,146],
    [140,19,134,132],
    [131,109],
    [131,130],
    [113,79,113,81,113,80,113,79,27,112,1,26,113,82,113,81,27,112,1,26,144],
    [113,80,113,79,27,112,1,26,113,82,113,81,27,112,1,26,145],
    [131,143],
    [112,1],
    [119,69,113,75],
    [113,69,37,129,213],
    [113,69,131,187],
    [113,69,4,128,209],
    [130]
  ]
}
