{
  "format":1,
  "language":"BASIC",
  "version":13,
  "name":"Noughts and crosses",
  "author":"Peter Millican",
  "date":"28/07/2020",
  "time":"13:25:48",
  "code":"REM NoughtsAndCrosses\n\nCONST CROSS%=33\nCONST NOUGHT%=2\nDIM board%(11)\nDIM b2%(9,11)\nnumgames%=0\nREPEAT\n numgames%=numgames%+1\n randfirst%=(numgames% MOD 2=1)\n BLANK(LIGHTGREEN)\n THICKNESS(10)\n COLOUR(BLACK)\n SETXY(375,50)\n DRAWXY(0,750)\n SETXY(625,50)\n DRAWXY(0,750)\n SETXY(125,300)\n DRAWXY(750,0)\n SETXY(125,550)\n DRAWXY(750,0)\n FOR i%=0 TO 10\n  board%(i%)=0\n NEXT\n board%(11)=8\n REPEAT\n  IF (randfirst%) THEN\n   board%(10)=RND(8)\n   randfirst%=FALSE\n  ELSE\n   CURSOR(2)\n   REPEAT\n    REPEAT\n     REPEAT\n     UNTIL ?LMOUSE>0\n     PAUSE(200)\n    UNTIL ((?CLICKX>=125) AND (?CLICKX<=875) AND (?CLICKY>=50) AND (?CLICKY<=800))\n    column%=(?CLICKX-125) DIV 250\n    row%=(?CLICKY-50) DIV 250\n   UNTIL board%(column%+row%*3)=0\n   PROCdoblot(column%,row%,CROSS%)\n   board%(column%+row%*3)=CROSS%\n   CURSOR(11)\n   PROCevaluate(board%,CROSS%,0)\n  ENDIF\n  IF (board%(10)<>-1) THEN\n   PROCdoblot(board%(10) MOD 3,board%(10) DIV 3,NOUGHT%)\n   board%(board%(10))=NOUGHT%\n  ENDIF\n UNTIL (board%(11)<=1)\n SETXY(350,850)\n COLOUR(BLACK)\n IF (board%(9)=0) THEN\n  PRINT(\"  Draw!  \",4,60)\n ELSE\n  PRINT(\"  I win!  \",4,60)\n ENDIF\n PAUSE(2500)\nUNTIL (1<>1)\nEND\n\nDEF PROCdoblot(x%,y%,col%)\n SETXY(x%*250+250,y%*250+175)\n COLOUR(RGB(col%))\n BLOT(70)\nENDPROC\n\nDEF PROCcopy(RETURN fromarray%(),RETURN toarray%())\n FOR i%=0 TO 11\n  toarray%(i%)=fromarray%(i%)\n NEXT\nENDPROC\n\nDEF PROCevaluate(RETURN b1%(),jm%,depth%)\n LOCAL mover%,replyscore%,m%\n mover%=CROSS%+NOUGHT%-jm%\n replyscore%=-2\n b1%(9)=0\n b1%(10)=-1\n b1%(11)=depth%\n IF ((b1%(0)=jm%) AND (b1%(1)=jm%) AND (b1%(2)=jm%)) THEN b1%(9)=1\n IF ((b1%(3)=jm%) AND (b1%(4)=jm%) AND (b1%(5)=jm%)) THEN b1%(9)=1\n IF ((b1%(6)=jm%) AND (b1%(7)=jm%) AND (b1%(8)=jm%)) THEN b1%(9)=1\n IF ((b1%(0)=jm%) AND (b1%(3)=jm%) AND (b1%(6)=jm%)) THEN b1%(9)=1\n IF ((b1%(1)=jm%) AND (b1%(4)=jm%) AND (b1%(7)=jm%)) THEN b1%(9)=1\n IF ((b1%(2)=jm%) AND (b1%(5)=jm%) AND (b1%(8)=jm%)) THEN b1%(9)=1\n IF ((b1%(0)=jm%) AND (b1%(4)=jm%) AND (b1%(8)=jm%)) THEN b1%(9)=1\n IF ((b1%(2)=jm%) AND (b1%(4)=jm%) AND (b1%(6)=jm%)) THEN b1%(9)=1\n IF b1%(9)=0 THEN\n  m%=0\n  REPEAT\n   IF (b1%(m%)=0) THEN\n    PROCcopy(b1%,b2%(depth%))\n    b2%(depth%,m%)=mover%\n    PROCevaluate(b2%(depth%),mover%,depth%+1)\n    IF (b2%(depth%,9)>replyscore%) THEN\n     replyscore%=b2%(depth%,9)\n     b1%(10)=m%\n     b1%(11)=b2%(depth%,11)\n    ENDIF\n   ENDIF\n   m%=m%+1\n  UNTIL (m%>8) OR (replyscore%>0)\n  IF (replyscore%<>-2) THEN b1%(9)=-replyscore%\n ENDIF\nENDPROC",
  "usage":[
    {
      "category": "Turtle: relative movement",
      "expressions":[
        {"name":"DRAWXY", "level":2, "count":4, "lines":"15 17 19 21"}
      ],
      "total":4
    },
    {
      "category": "Turtle: absolute movement",
      "expressions":[
        {"name":"SETXY", "level":1, "count":6, "lines":"63 14 16 18 20 51"}
      ],
      "total":6
    },
    {
      "category": "Turtle: drawing shapes",
      "expressions":[
        {"name":"BLOT", "level":1, "count":1, "lines":"65"}
      ],
      "total":1
    },
    {
      "category": "Other Turtle commands",
      "expressions":[
        {"name":"COLOUR", "level":1, "count":3, "lines":"64 13 52"},
        {"name":"THICKNESS", "level":1, "count":1, "lines":"12"},
        {"name":"RGB", "level":3, "count":1, "lines":"64"}
      ],
      "total":5
    },
    {
      "category": "Canvas operations",
      "expressions":[
        {"name":"BLANK", "level":1, "count":1, "lines":"11"}
      ],
      "total":1
    },
    {
      "category": "General arithmetic functions",
      "expressions":[
        {"name":"RND", "level":2, "count":1, "lines":"28"}
      ],
      "total":1
    },
    {
      "category": "String operations",
      "expressions":[
        {"name":"PRINT", "level":1, "count":2, "lines":"54 56"}
      ],
      "total":2
    },
    {
      "category": "Input and timing routines",
      "expressions":[
        {"name":"PAUSE", "level":1, "count":2, "lines":"36 58"},
        {"name":"CURSOR", "level":2, "count":2, "lines":"31 43"}
      ],
      "total":4
    },
    {
      "category": "Command structures",
      "expressions":[
        {"name":"IF", "level":1, "count":15, "lines":"81 82 83 84 85 86 87 88 89 92 96 104 27 46 53"},
        {"name":"ELSE", "level":1, "count":2, "lines":"30 55"},
        {"name":"FOR", "level":1, "count":2, "lines":"69 22"},
        {"name":"REPEAT", "level":2, "count":6, "lines":"91 8 26 32 33 34"},
        {"name":"DEF PROC", "level":2, "count":3, "lines":"62 68 74"}
      ],
      "total":28
    },
    {
      "category": "Subroutine calls",
      "expressions":[
        {"name":"PROCcopy", "level":0, "count":1, "lines":"93"},
        {"name":"PROCevaluate", "level":0, "count":2, "lines":"95 44"},
        {"name":"PROCdoblot", "level":0, "count":2, "lines":"41 47"}
      ],
      "total":5
    }
  ],
  "pcode":[
    [112,15,1,1,112,0,123,112,6,2,123,4,112,167,124,112,182,138],
    [80,112,2,85,112,360,84,112,32,162,112,1,123,141,112,0,1,112,1000,1,1,1,145,144],
    [116,23,119,22],
    [112,12,119,23],
    [116,37,119,36],
    [112,10,119,37,116,48,119,38],
    [112,12,119,48,116,61,119,39],
    [112,12,119,61,116,74,119,40],
    [112,12,119,74,116,87,119,41],
    [112,12,119,87,116,100,119,42],
    [112,12,119,100,116,113,119,43],
    [112,12,119,113,116,126,119,44],
    [112,12,119,126,116,139,119,45],
    [112,12,119,139,116,152,119,46],
    [112,12,119,152,116,165,119,47],
    [112,12,119,165],
    [128,73],
    [133,1],
    [139,12,3],
    [117,12,1,112,3,124,120,12,3,120,12,2,120,12,1],
    [114,12,1,112,250,28,112,250,26,114,12,2,112,250,28,112,175,26,88],
    [114,12,3,101,87],
    [112,70,108],
    [140,12,134,132],
    [133,2],
    [139,13,2],
    [117,13,1,112,2,124,120,13,2,120,13,1],
    [112,0],
    [119,180,112,11],
    [113,180,37,129,33],
    [114,13,2,113,180,2,127,26,4,114,13,1,113,180,2,127,26,4,122,2,123],
    [113,180,4,128,29],
    [140,13,134,132],
    [133,3],
    [139,14,6],
    [117,14,1,112,6,124,120,14,3,120,14,2,120,14,1],
    [112,33,112,2,26,114,14,2,27,120,14,4],
    [112,2,23,120,14,5],
    [114,14,1,112,9,2,127,26,4,112,0,2,123],
    [114,14,1,112,10,2,127,26,4,112,1,23,2,123],
    [114,14,1,112,11,2,127,26,4,114,14,3,2,123],
    [114,14,1,112,0,2,127,26,4,122,114,14,2,32,114,14,1,112,1,2,127,26,4,122,114,14,2,32,17,114,14,1,112,2,2,127,26,4,122,114,14,2,32,17,129,44],
    [114,14,1,112,9,2,127,26,4,112,1,2,123],
    [114,14,1,112,3,2,127,26,4,122,114,14,2,32,114,14,1,112,4,2,127,26,4,122,114,14,2,32,17,114,14,1,112,5,2,127,26,4,122,114,14,2,32,17,129,46],
    [114,14,1,112,9,2,127,26,4,112,1,2,123],
    [114,14,1,112,6,2,127,26,4,122,114,14,2,32,114,14,1,112,7,2,127,26,4,122,114,14,2,32,17,114,14,1,112,8,2,127,26,4,122,114,14,2,32,17,129,48],
    [114,14,1,112,9,2,127,26,4,112,1,2,123],
    [114,14,1,112,0,2,127,26,4,122,114,14,2,32,114,14,1,112,3,2,127,26,4,122,114,14,2,32,17,114,14,1,112,6,2,127,26,4,122,114,14,2,32,17,129,50],
    [114,14,1,112,9,2,127,26,4,112,1,2,123],
    [114,14,1,112,1,2,127,26,4,122,114,14,2,32,114,14,1,112,4,2,127,26,4,122,114,14,2,32,17,114,14,1,112,7,2,127,26,4,122,114,14,2,32,17,129,52],
    [114,14,1,112,9,2,127,26,4,112,1,2,123],
    [114,14,1,112,2,2,127,26,4,122,114,14,2,32,114,14,1,112,5,2,127,26,4,122,114,14,2,32,17,114,14,1,112,8,2,127,26,4,122,114,14,2,32,17,129,54],
    [114,14,1,112,9,2,127,26,4,112,1,2,123],
    [114,14,1,112,0,2,127,26,4,122,114,14,2,32,114,14,1,112,4,2,127,26,4,122,114,14,2,32,17,114,14,1,112,8,2,127,26,4,122,114,14,2,32,17,129,56],
    [114,14,1,112,9,2,127,26,4,112,1,2,123],
    [114,14,1,112,2,2,127,26,4,122,114,14,2,32,114,14,1,112,4,2,127,26,4,122,114,14,2,32,17,114,14,1,112,6,2,127,26,4,122,114,14,2,32,17,129,58],
    [114,14,1,112,9,2,127,26,4,112,1,2,123],
    [114,14,1,112,9,2,127,26,4,122,112,0,32,129,72],
    [112,0,120,14,6],
    [114,14,1,114,14,6,2,127,26,4,122,112,0,32,129,68],
    [114,14,1,113,36,114,14,3,2,127,26,4,122,131,25],
    [113,36,114,14,3,2,127,26,4,122,114,14,6,2,127,26,4,114,14,4,2,123],
    [113,36,114,14,3,2,127,26,4,122,114,14,4,114,14,3,112,1,26,131,34],
    [113,36,114,14,3,2,127,26,4,122,112,9,2,127,26,4,122,114,14,5,35,129,68],
    [113,36,114,14,3,2,127,26,4,122,112,9,2,127,26,4,122,120,14,5],
    [114,14,1,112,10,2,127,26,4,114,14,6,2,123],
    [114,14,1,112,11,2,127,26,4,113,36,114,14,3,2,127,26,4,122,112,11,2,127,26,4,122,2,123],
    [114,14,6,112,1,26,120,14,6],
    [114,14,6,112,8,35,114,14,5,112,0,35,18,129,60],
    [114,14,5,112,2,23,33,129,72],
    [114,14,1,112,9,2,127,26,4,114,14,5,23,2,123],
    [140,14,134,132],
    [112,0,119,178],
    [113,178,112,1,26,119,178],
    [113,178,112,2,31,112,1,32,119,179],
    [112,10025880,96],
    [112,10,85],
    [112,0,87],
    [112,375,112,50,88],
    [112,0,112,750,90],
    [112,625,112,50,88],
    [112,0,112,750,90],
    [112,125,112,300,88],
    [112,750,112,0,90],
    [112,125,112,550,88],
    [112,750,112,0,90],
    [112,0],
    [119,180,112,10],
    [113,180,37,129,92],
    [113,22,113,180,2,127,26,4,112,0,2,123],
    [113,180,4,128,88],
    [113,22,112,11,2,127,26,4,112,8,2,123],
    [113,179,129,97],
    [113,22,112,10,2,127,26,4,112,8,7,4,2,123],
    [112,0,119,179],
    [128,108],
    [112,2,171],
    [112,-1,160,112,0,35,129,98],
    [112,200,174],
    [112,-5,160,112,125,37,112,-5,160,112,875,36,17,112,-6,160,112,50,37,17,112,-6,160,112,800,36,17,129,98],
    [112,-5,160,112,125,27,112,250,30,119,181],
    [112,-6,160,112,50,27,112,250,30,119,182],
    [113,22,113,181,113,182,112,3,28,26,2,127,26,4,122,112,0,32,129,98],
    [113,181,113,182,112,33,131,18],
    [113,22,113,181,113,182,112,3,28,26,2,127,26,4,112,33,2,123],
    [112,11,171],
    [113,22,112,33,112,0,131,34],
    [113,22,112,10,2,127,26,4,122,112,1,23,33,129,111],
    [113,22,112,10,2,127,26,4,122,112,3,31,113,22,112,10,2,127,26,4,122,112,3,30,112,2,131,18],
    [113,22,113,22,112,10,2,127,26,4,122,2,127,26,4,112,2,2,123],
    [113,22,112,11,2,127,26,4,122,112,1,36,129,93],
    [112,350,112,850,88],
    [112,0,87],
    [113,22,112,9,2,127,26,4,122,112,0,32,129,117],
    [118,9,32,32,68,114,97,119,33,32,32,112,4,112,60,168,142],
    [128,118],
    [118,10,32,32,73,32,119,105,110,33,32,32,112,4,112,60,168,142],
    [112,2500,174],
    [112,1,112,1,33,129,74],
    [130]
  ]
}
